<%= semantic_form_for [:admin, @shift],
      builder: ActiveAdmin::FormBuilder do |f| %>
  <%= f.semantic_errors %>

  <%= f.inputs do %>
    <%= f.input :date, as: :datepicker, input_html: { disabled: true } %>
    <%= f.input :start_time, as: :time_picker, input_html: { disabled: true } %>
    <%= f.input :finish_time, as: :time_picker, input_html: { disabled: true } %>
    <%= f.input :rank, as: :select, collection: Shift::RANKS,
                       include_blank: false, input_html: { disabled: true } %>
    <%= f.input :male_count, input_html: { disabled: true } %>
    <%= f.input :female_count, input_html: { disabled: true } %>
    <%= f.input :comment, as: :text, input_html: { disabled: true } %>
  <% end %>

  <%= f.inputs 'Официанты мужчины' do %>
    <% (@shift.male_count - @shift.payments.joins(:waiter).where(waiters: {gender: 'Мужской'}).count).times do %>
      <% f.object.payments.build %>
    <% end %>
    <% f.fields_for :payments do |m| %>
      <%= m.inputs do %>
         <%= m.input :waiter, as: :select, collection: Waiter.male, include_blank: false %>
        <%= m.input :is_main %>
        <%= m.input :is_coordinator %>
        <%= m.input :is_reserve %>
      <% end %>
    <% end %>
  <% end %>

  <%= f.inputs 'Официанты женщины' do %>
    <% (@shift.female_count - @shift.male_count - @shift.payments.joins(:waiter).where(waiters: {gender: 'Женский'}).count).times do %>
      <% f.object.payments.build %>
    <% end %>
    <% f.fields_for :payments do |m| %>
      <%= m.inputs do %>
        <%= m.input :waiter, as: :select, collection: Waiter.female, include_blank: false %>
        <%= m.input :is_main %>
        <%= m.input :is_coordinator %>
        <%= m.input :is_reserve %>
      <% end %>
    <% end %>
  <% end %>
  <%= f.actions %>
<% end %>